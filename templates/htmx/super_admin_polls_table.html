<div class="table-responsive">
    <table class="table table-hover poll-table mb-0">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Status</th>
                <th>Server</th>
                <th>Creator</th>
                <th>Votes</th>
                <th>Created</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for poll in polls %}
            <tr>
                <td>
                    <span class="badge bg-secondary">#{{ poll.id }}</span>
                </td>
                <td>
                    <div class="fw-bold">{{ poll.name[:30] }}{% if poll.name|length > 30 %}...{% endif %}</div>
                    <small class="text-muted">{{ poll.question[:50] }}{% if poll.question|length > 50 %}...{% endif %}</small>
                </td>
                <td>
                    <span class="badge status-badge {% if poll.status == 'active' %}bg-success{% elif poll.status == 'scheduled' %}bg-warning{% else %}bg-secondary{% endif %}">
                        {{ poll.status.upper() }}
                    </span>
                    {% if poll.anonymous %}
                    <br><small class="text-muted"><i class="fas fa-eye-slash"></i> Anonymous</small>
                    {% endif %}
                    {% if poll.multiple_choice %}
                    <br><small class="text-muted"><i class="fas fa-list"></i> Multiple Choice</small>
                    {% endif %}
                </td>
                <td>
                    <div class="fw-bold">{{ poll.server_name[:20] }}{% if poll.server_name|length > 20 %}...{% endif %}</div>
                    <small class="text-muted">#{{ poll.channel_name }}</small>
                    <br><small class="text-muted">{{ poll.server_id }}</small>
                </td>
                <td>
                    <div>{{ poll.creator_username or 'Unknown' }}</div>
                    <small class="text-muted">{{ poll.creator_id[:8] }}...</small>
                </td>
                <td>
                    <div class="fw-bold">{{ poll.vote_count }}</div>
                    <small class="text-muted">{{ poll.unique_voters }} unique</small>
                </td>
                <td>
                    <div>{{ poll.created_at.strftime('%m/%d/%y') }}</div>
                    <small class="text-muted">{{ poll.created_at.strftime('%H:%M') }}</small>
                </td>
                <td>
                    <div class="action-buttons">
                        <button class="btn btn-sm btn-outline-primary" onclick="viewPollDetails({{ poll.id }})" title="View Details">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-info" onclick="editPoll({{ poll.id }})" title="Edit Poll">
                            <i class="fas fa-edit"></i>
                        </button>
                        {% if poll.status != 'closed' %}
                        <button class="btn btn-sm btn-outline-warning" onclick="forceClosePoll({{ poll.id }}, '{{ poll.name|replace("'", "\\'") }}')" title="Force Close">
                            <i class="fas fa-stop"></i>
                        </button>
                        {% else %}
                        <button class="btn btn-sm btn-outline-success" onclick="reopenPoll({{ poll.id }}, '{{ poll.name|replace("'", "\\'") }}')" title="Reopen Poll">
                            <i class="fas fa-play"></i>
                        </button>
                        {% endif %}
                        <button class="btn btn-sm btn-outline-danger" onclick="deletePoll({{ poll.id }}, '{{ poll.name|replace("'", "\\'") }}')" title="Delete">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% if polls|length == 0 %}
<div class="text-center p-4">
    <i class="fas fa-inbox fa-3x text-muted mb-3"></i>
    <h5 class="text-muted">No polls found</h5>
    <p class="text-muted">No polls match the current filters.</p>
</div>
{% endif %}

<!-- Pagination -->
{% if total_count > 25 %}
<div class="d-flex justify-content-between align-items-center p-3 border-top">
    <div class="text-muted">
        Showing {{ ((current_page - 1) * 25) + 1 }} to {{ ((current_page - 1) * 25) + polls|length }} of {{ total_count }} polls
    </div>
    <div>
        {% if current_page > 1 %}
        <button class="btn btn-sm btn-outline-primary me-1" onclick="loadPage({{ current_page - 1 }})">
            <i class="fas fa-chevron-left"></i> Previous
        </button>
        {% endif %}
        
        <span class="mx-2">Page {{ current_page }}</span>
        
        {% if has_more %}
        <button class="btn btn-sm btn-outline-primary ms-1" onclick="loadPage({{ current_page + 1 }})">
            Next <i class="fas fa-chevron-right"></i>
        </button>
        {% endif %}
    </div>
</div>
{% endif %}
